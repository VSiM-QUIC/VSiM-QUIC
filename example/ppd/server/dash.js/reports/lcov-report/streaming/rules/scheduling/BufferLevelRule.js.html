<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for streaming/rules/scheduling/BufferLevelRule.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../prettify.css" />
    <link rel="stylesheet" href="../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../index.html">all files</a> / <a href="index.html">streaming/rules/scheduling/</a> BufferLevelRule.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">90.38% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>47/52</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">71.43% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>20/28</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>5/5</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">90.2% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>46/51</span>
      </div>
      <div class='fl pad1y'>
        <span class="strong">1 branch</span>
        <span class="quiet">Ignored</span>  &nbsp;&nbsp;&nbsp;&nbsp;
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * The copyright in this software is being made available under the BSD License,
 * included below. This software may be subject to other third party and contributor
 * rights, including patent rights, and no such rights are granted under this license.
 *
 * Copyright (c) 2013, Dash Industry Forum.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *  * Redistributions of source code must retain the above copyright notice, this
 *  list of conditions and the following disclaimer.
 *  * Redistributions in binary form must reproduce the above copyright notice,
 *  this list of conditions and the following disclaimer in the documentation and/or
 *  other materials provided with the distribution.
 *  * Neither the name of Dash Industry Forum nor the names of its
 *  contributors may be used to endorse or promote products derived from this software
 *  without specific prior written permission.
 *
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY
 *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 *  POSSIBILITY OF SUCH DAMAGE.
 */
'use strict';
&nbsp;
Object.defineProperty(exports, '__esModule', {
    value: true
});
// istanbul ignore next
&nbsp;
function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? <span class="branch-0 cbranch-skip" title="branch not covered" >obj </span>: { 'default': obj }; }
&nbsp;
var _constantsConstants = require('../../constants/Constants');
&nbsp;
var _constantsConstants2 = _interopRequireDefault(_constantsConstants);
&nbsp;
var _coreFactoryMaker = require('../../../core/FactoryMaker');
&nbsp;
var _coreFactoryMaker2 = _interopRequireDefault(_coreFactoryMaker);
&nbsp;
var _constantsMetricsConstants = require('../../constants/MetricsConstants');
&nbsp;
var _constantsMetricsConstants2 = _interopRequireDefault(_constantsMetricsConstants);
&nbsp;
function BufferLevelRule(config) {
&nbsp;
    config = config || <span class="branch-1 cbranch-no" title="branch not covered" >{};</span>
    var dashMetrics = config.dashMetrics;
    var mediaPlayerModel = config.mediaPlayerModel;
    var textController = config.textController;
    var abrController = config.abrController;
    var settings = config.settings;
&nbsp;
    function setup() {}
&nbsp;
    function execute(streamProcessor, videoTrackPresent) {
        if (!streamProcessor) {
            return true;
        }
        var bufferLevel = dashMetrics.getCurrentBufferLevel(streamProcessor.getType());
        return bufferLevel &lt; getBufferTarget(streamProcessor, videoTrackPresent);
    }
&nbsp;
    function getBufferTarget(streamProcessor, videoTrackPresent) {
        var bufferTarget = NaN;
&nbsp;
        if (!streamProcessor) {
            return bufferTarget;
        }
        var type = streamProcessor.getType();
        var representationInfo = streamProcessor.getRepresentationInfo();
        if (type === _constantsConstants2['default'].FRAGMENTED_TEXT) {
            if (textController.isTextEnabled()) {
                <span class="missing-if-branch" title="if path not taken" >I</span>if (isNaN(representationInfo.fragmentDuration)) {
                    //fragmentDuration of representationInfo is not defined,
                    // call metrics function to have data in the latest scheduling info...
                    // if no metric, returns 0. In this case, rule will return false.
<span class="cstat-no" title="statement not covered" >                    var schedulingInfo = dashMetrics.getCurrentSchedulingInfo(_constantsMetricsConstants2['default'].SCHEDULING_INFO);</span>
<span class="cstat-no" title="statement not covered" >                    bufferTarget = schedulingInfo ? schedulingInfo.duration : 0;</span>
                } else {
                    bufferTarget = representationInfo.fragmentDuration;
                }
            } else {
                // text is disabled, rule will return false
                bufferTarget = 0;
            }
        } else if (type === _constantsConstants2['default'].AUDIO &amp;&amp; videoTrackPresent) {
            var videoBufferLevel = dashMetrics.getCurrentBufferLevel(_constantsConstants2['default'].VIDEO);
            <span class="missing-if-branch" title="if path not taken" >I</span>if (isNaN(representationInfo.fragmentDuration)) {
<span class="cstat-no" title="statement not covered" >                bufferTarget = videoBufferLevel;</span>
            } else {
                bufferTarget = Math.max(videoBufferLevel, representationInfo.fragmentDuration);
            }
        } else {
            var streamInfo = representationInfo.mediaInfo.streamInfo;
            <span class="missing-if-branch" title="if path not taken" >I</span>if (abrController.isPlayingAtTopQuality(streamInfo)) {
<span class="cstat-no" title="statement not covered" >                var isLongFormContent = streamInfo.manifestInfo.duration &gt;= settings.get().streaming.longFormContentDurationThreshold;</span>
<span class="cstat-no" title="statement not covered" >                bufferTarget = isLongFormContent ? settings.get().streaming.bufferTimeAtTopQualityLongForm : settings.get().streaming.bufferTimeAtTopQuality;</span>
            } else {
                bufferTarget = mediaPlayerModel.getStableBufferTime();
            }
        }
        return bufferTarget;
    }
&nbsp;
    var instance = {
        execute: execute,
        getBufferTarget: getBufferTarget
    };
&nbsp;
    setup();
    return instance;
}
&nbsp;
BufferLevelRule.__dashjs_factory_name = 'BufferLevelRule';
exports['default'] = _coreFactoryMaker2['default'].getClassFactory(BufferLevelRule);
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3Byb25heWEvZ28vc3JjL2dpdGh1Yi5jb20vbHVjYXMtY2xlbWVudGUvcXVpYy1nby9leGFtcGxlL3BwZC9zZXJ2ZXIvZGFzaC5qcy9zcmMvc3RyZWFtaW5nL3J1bGVzL3NjaGVkdWxpbmcvQnVmZmVyTGV2ZWxSdWxlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrQ0E4QnNCLDJCQUEyQjs7OztnQ0FDeEIsNEJBQTRCOzs7O3lDQUN4QixrQ0FBa0M7Ozs7QUFFL0QsU0FBUyxlQUFlLENBQUMsTUFBTSxFQUFFOztBQUU3QixVQUFNLEdBQUcsTUFBTSxJQUFJLEVBQUUsQ0FBQztBQUN0QixRQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDO0FBQ3ZDLFFBQU0sZ0JBQWdCLEdBQUcsTUFBTSxDQUFDLGdCQUFnQixDQUFDO0FBQ2pELFFBQU0sY0FBYyxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUM7QUFDN0MsUUFBTSxhQUFhLEdBQUcsTUFBTSxDQUFDLGFBQWEsQ0FBQztBQUMzQyxRQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDOztBQUVqQyxhQUFTLEtBQUssR0FBRyxFQUNoQjs7QUFFRCxhQUFTLE9BQU8sQ0FBQyxlQUFlLEVBQUUsaUJBQWlCLEVBQUU7QUFDakQsWUFBSSxDQUFDLGVBQWUsRUFBRTtBQUNsQixtQkFBTyxJQUFJLENBQUM7U0FDZjtBQUNELFlBQU0sV0FBVyxHQUFHLFdBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztBQUNqRixlQUFPLFdBQVcsR0FBRyxlQUFlLENBQUMsZUFBZSxFQUFFLGlCQUFpQixDQUFDLENBQUM7S0FDNUU7O0FBRUQsYUFBUyxlQUFlLENBQUMsZUFBZSxFQUFFLGlCQUFpQixFQUFFO0FBQ3pELFlBQUksWUFBWSxHQUFHLEdBQUcsQ0FBQzs7QUFFdkIsWUFBSSxDQUFDLGVBQWUsRUFBRTtBQUNsQixtQkFBTyxZQUFZLENBQUM7U0FDdkI7QUFDRCxZQUFNLElBQUksR0FBRyxlQUFlLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDdkMsWUFBTSxrQkFBa0IsR0FBRyxlQUFlLENBQUMscUJBQXFCLEVBQUUsQ0FBQztBQUNuRSxZQUFJLElBQUksS0FBSyxnQ0FBVSxlQUFlLEVBQUU7QUFDcEMsZ0JBQUksY0FBYyxDQUFDLGFBQWEsRUFBRSxFQUFFO0FBQ2hDLG9CQUFJLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFOzs7O0FBRzVDLHdCQUFNLGNBQWMsR0FBRyxXQUFXLENBQUMsd0JBQXdCLENBQUMsdUNBQWlCLGVBQWUsQ0FBQyxDQUFDO0FBQzlGLGdDQUFZLEdBQUcsY0FBYyxHQUFHLGNBQWMsQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDO2lCQUMvRCxNQUFNO0FBQ0gsZ0NBQVksR0FBRyxrQkFBa0IsQ0FBQyxnQkFBZ0IsQ0FBQztpQkFDdEQ7YUFDSixNQUFNOztBQUNILDRCQUFZLEdBQUcsQ0FBQyxDQUFDO2FBQ3BCO1NBQ0osTUFBTSxJQUFJLElBQUksS0FBSyxnQ0FBVSxLQUFLLElBQUksaUJBQWlCLEVBQUU7QUFDdEQsZ0JBQU0sZ0JBQWdCLEdBQUcsV0FBVyxDQUFDLHFCQUFxQixDQUFDLGdDQUFVLEtBQUssQ0FBQyxDQUFDO0FBQzVFLGdCQUFJLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFO0FBQzVDLDRCQUFZLEdBQUcsZ0JBQWdCLENBQUM7YUFDbkMsTUFBTTtBQUNILDRCQUFZLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxrQkFBa0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2FBQ2xGO1NBQ0osTUFBTTtBQUNILGdCQUFNLFVBQVUsR0FBRyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDO0FBQzNELGdCQUFJLGFBQWEsQ0FBQyxxQkFBcUIsQ0FBQyxVQUFVLENBQUMsRUFBRTtBQUNqRCxvQkFBTSxpQkFBaUIsR0FBRyxVQUFVLENBQUMsWUFBWSxDQUFDLFFBQVEsSUFBSSxRQUFRLENBQUMsR0FBRyxFQUFFLENBQUMsU0FBUyxDQUFDLGdDQUFnQyxDQUFDO0FBQ3hILDRCQUFZLEdBQUcsaUJBQWlCLEdBQUcsUUFBUSxDQUFDLEdBQUcsRUFBRSxDQUFDLFNBQVMsQ0FBQyw4QkFBOEIsR0FBRyxRQUFRLENBQUMsR0FBRyxFQUFFLENBQUMsU0FBUyxDQUFDLHNCQUFzQixDQUFDO2FBQ2hKLE1BQU07QUFDSCw0QkFBWSxHQUFHLGdCQUFnQixDQUFDLG1CQUFtQixFQUFFLENBQUM7YUFDekQ7U0FDSjtBQUNELGVBQU8sWUFBWSxDQUFDO0tBQ3ZCOztBQUVELFFBQU0sUUFBUSxHQUFHO0FBQ2IsZUFBTyxFQUFFLE9BQU87QUFDaEIsdUJBQWUsRUFBRSxlQUFlO0tBQ25DLENBQUM7O0FBRUYsU0FBSyxFQUFFLENBQUM7QUFDUixXQUFPLFFBQVEsQ0FBQztDQUNuQjs7QUFFRCxlQUFlLENBQUMscUJBQXFCLEdBQUcsaUJBQWlCLENBQUM7cUJBQzNDLDhCQUFhLGVBQWUsQ0FBQyxlQUFlLENBQUMiLCJmaWxlIjoiL2hvbWUvcHJvbmF5YS9nby9zcmMvZ2l0aHViLmNvbS9sdWNhcy1jbGVtZW50ZS9xdWljLWdvL2V4YW1wbGUvcHBkL3NlcnZlci9kYXNoLmpzL3NyYy9zdHJlYW1pbmcvcnVsZXMvc2NoZWR1bGluZy9CdWZmZXJMZXZlbFJ1bGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRoZSBjb3B5cmlnaHQgaW4gdGhpcyBzb2Z0d2FyZSBpcyBiZWluZyBtYWRlIGF2YWlsYWJsZSB1bmRlciB0aGUgQlNEIExpY2Vuc2UsXG4gKiBpbmNsdWRlZCBiZWxvdy4gVGhpcyBzb2Z0d2FyZSBtYXkgYmUgc3ViamVjdCB0byBvdGhlciB0aGlyZCBwYXJ0eSBhbmQgY29udHJpYnV0b3JcbiAqIHJpZ2h0cywgaW5jbHVkaW5nIHBhdGVudCByaWdodHMsIGFuZCBubyBzdWNoIHJpZ2h0cyBhcmUgZ3JhbnRlZCB1bmRlciB0aGlzIGxpY2Vuc2UuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDEzLCBEYXNoIEluZHVzdHJ5IEZvcnVtLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQgbW9kaWZpY2F0aW9uLFxuICogYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICogICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLCB0aGlzXG4gKiAgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKiAgKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsXG4gKiAgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3JcbiAqICBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuICogICogTmVpdGhlciB0aGUgbmFtZSBvZiBEYXNoIEluZHVzdHJ5IEZvcnVtIG5vciB0aGUgbmFtZXMgb2YgaXRzXG4gKiAgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZVxuICogIHdpdGhvdXQgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLlxuICpcbiAqICBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIEFTIElTIEFORCBBTllcbiAqICBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRSBJTVBMSUVEXG4gKiAgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELlxuICogIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBDT1BZUklHSFQgSE9MREVSIE9SIENPTlRSSUJVVE9SUyBCRSBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsXG4gKiAgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVFxuICogIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1JcbiAqICBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORCBPTiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSxcbiAqICBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpXG4gKiAgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVMgU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEVcbiAqICBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiAqL1xuaW1wb3J0IENvbnN0YW50cyBmcm9tICcuLi8uLi9jb25zdGFudHMvQ29uc3RhbnRzJztcbmltcG9ydCBGYWN0b3J5TWFrZXIgZnJvbSAnLi4vLi4vLi4vY29yZS9GYWN0b3J5TWFrZXInO1xuaW1wb3J0IE1ldHJpY3NDb25zdGFudHMgZnJvbSAnLi4vLi4vY29uc3RhbnRzL01ldHJpY3NDb25zdGFudHMnO1xuXG5mdW5jdGlvbiBCdWZmZXJMZXZlbFJ1bGUoY29uZmlnKSB7XG5cbiAgICBjb25maWcgPSBjb25maWcgfHwge307XG4gICAgY29uc3QgZGFzaE1ldHJpY3MgPSBjb25maWcuZGFzaE1ldHJpY3M7XG4gICAgY29uc3QgbWVkaWFQbGF5ZXJNb2RlbCA9IGNvbmZpZy5tZWRpYVBsYXllck1vZGVsO1xuICAgIGNvbnN0IHRleHRDb250cm9sbGVyID0gY29uZmlnLnRleHRDb250cm9sbGVyO1xuICAgIGNvbnN0IGFickNvbnRyb2xsZXIgPSBjb25maWcuYWJyQ29udHJvbGxlcjtcbiAgICBjb25zdCBzZXR0aW5ncyA9IGNvbmZpZy5zZXR0aW5ncztcblxuICAgIGZ1bmN0aW9uIHNldHVwKCkge1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGV4ZWN1dGUoc3RyZWFtUHJvY2Vzc29yLCB2aWRlb1RyYWNrUHJlc2VudCkge1xuICAgICAgICBpZiAoIXN0cmVhbVByb2Nlc3Nvcikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYnVmZmVyTGV2ZWwgPSBkYXNoTWV0cmljcy5nZXRDdXJyZW50QnVmZmVyTGV2ZWwoc3RyZWFtUHJvY2Vzc29yLmdldFR5cGUoKSk7XG4gICAgICAgIHJldHVybiBidWZmZXJMZXZlbCA8IGdldEJ1ZmZlclRhcmdldChzdHJlYW1Qcm9jZXNzb3IsIHZpZGVvVHJhY2tQcmVzZW50KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRCdWZmZXJUYXJnZXQoc3RyZWFtUHJvY2Vzc29yLCB2aWRlb1RyYWNrUHJlc2VudCkge1xuICAgICAgICBsZXQgYnVmZmVyVGFyZ2V0ID0gTmFOO1xuXG4gICAgICAgIGlmICghc3RyZWFtUHJvY2Vzc29yKSB7XG4gICAgICAgICAgICByZXR1cm4gYnVmZmVyVGFyZ2V0O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHR5cGUgPSBzdHJlYW1Qcm9jZXNzb3IuZ2V0VHlwZSgpO1xuICAgICAgICBjb25zdCByZXByZXNlbnRhdGlvbkluZm8gPSBzdHJlYW1Qcm9jZXNzb3IuZ2V0UmVwcmVzZW50YXRpb25JbmZvKCk7XG4gICAgICAgIGlmICh0eXBlID09PSBDb25zdGFudHMuRlJBR01FTlRFRF9URVhUKSB7XG4gICAgICAgICAgICBpZiAodGV4dENvbnRyb2xsZXIuaXNUZXh0RW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKHJlcHJlc2VudGF0aW9uSW5mby5mcmFnbWVudER1cmF0aW9uKSkgeyAvL2ZyYWdtZW50RHVyYXRpb24gb2YgcmVwcmVzZW50YXRpb25JbmZvIGlzIG5vdCBkZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICAvLyBjYWxsIG1ldHJpY3MgZnVuY3Rpb24gdG8gaGF2ZSBkYXRhIGluIHRoZSBsYXRlc3Qgc2NoZWR1bGluZyBpbmZvLi4uXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIG5vIG1ldHJpYywgcmV0dXJucyAwLiBJbiB0aGlzIGNhc2UsIHJ1bGUgd2lsbCByZXR1cm4gZmFsc2UuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjaGVkdWxpbmdJbmZvID0gZGFzaE1ldHJpY3MuZ2V0Q3VycmVudFNjaGVkdWxpbmdJbmZvKE1ldHJpY3NDb25zdGFudHMuU0NIRURVTElOR19JTkZPKTtcbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyVGFyZ2V0ID0gc2NoZWR1bGluZ0luZm8gPyBzY2hlZHVsaW5nSW5mby5kdXJhdGlvbiA6IDA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyVGFyZ2V0ID0gcmVwcmVzZW50YXRpb25JbmZvLmZyYWdtZW50RHVyYXRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHsgLy8gdGV4dCBpcyBkaXNhYmxlZCwgcnVsZSB3aWxsIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgIGJ1ZmZlclRhcmdldCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gQ29uc3RhbnRzLkFVRElPICYmIHZpZGVvVHJhY2tQcmVzZW50KSB7XG4gICAgICAgICAgICBjb25zdCB2aWRlb0J1ZmZlckxldmVsID0gZGFzaE1ldHJpY3MuZ2V0Q3VycmVudEJ1ZmZlckxldmVsKENvbnN0YW50cy5WSURFTyk7XG4gICAgICAgICAgICBpZiAoaXNOYU4ocmVwcmVzZW50YXRpb25JbmZvLmZyYWdtZW50RHVyYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgYnVmZmVyVGFyZ2V0ID0gdmlkZW9CdWZmZXJMZXZlbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYnVmZmVyVGFyZ2V0ID0gTWF0aC5tYXgodmlkZW9CdWZmZXJMZXZlbCwgcmVwcmVzZW50YXRpb25JbmZvLmZyYWdtZW50RHVyYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgc3RyZWFtSW5mbyA9IHJlcHJlc2VudGF0aW9uSW5mby5tZWRpYUluZm8uc3RyZWFtSW5mbztcbiAgICAgICAgICAgIGlmIChhYnJDb250cm9sbGVyLmlzUGxheWluZ0F0VG9wUXVhbGl0eShzdHJlYW1JbmZvKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzTG9uZ0Zvcm1Db250ZW50ID0gc3RyZWFtSW5mby5tYW5pZmVzdEluZm8uZHVyYXRpb24gPj0gc2V0dGluZ3MuZ2V0KCkuc3RyZWFtaW5nLmxvbmdGb3JtQ29udGVudER1cmF0aW9uVGhyZXNob2xkO1xuICAgICAgICAgICAgICAgIGJ1ZmZlclRhcmdldCA9IGlzTG9uZ0Zvcm1Db250ZW50ID8gc2V0dGluZ3MuZ2V0KCkuc3RyZWFtaW5nLmJ1ZmZlclRpbWVBdFRvcFF1YWxpdHlMb25nRm9ybSA6IHNldHRpbmdzLmdldCgpLnN0cmVhbWluZy5idWZmZXJUaW1lQXRUb3BRdWFsaXR5O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBidWZmZXJUYXJnZXQgPSBtZWRpYVBsYXllck1vZGVsLmdldFN0YWJsZUJ1ZmZlclRpbWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYnVmZmVyVGFyZ2V0O1xuICAgIH1cblxuICAgIGNvbnN0IGluc3RhbmNlID0ge1xuICAgICAgICBleGVjdXRlOiBleGVjdXRlLFxuICAgICAgICBnZXRCdWZmZXJUYXJnZXQ6IGdldEJ1ZmZlclRhcmdldFxuICAgIH07XG5cbiAgICBzZXR1cCgpO1xuICAgIHJldHVybiBpbnN0YW5jZTtcbn1cblxuQnVmZmVyTGV2ZWxSdWxlLl9fZGFzaGpzX2ZhY3RvcnlfbmFtZSA9ICdCdWZmZXJMZXZlbFJ1bGUnO1xuZXhwb3J0IGRlZmF1bHQgRmFjdG9yeU1ha2VyLmdldENsYXNzRmFjdG9yeShCdWZmZXJMZXZlbFJ1bGUpO1xuIl19</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon May 04 2020 21:01:31 GMT+0200 (Central European Summer Time)
</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
